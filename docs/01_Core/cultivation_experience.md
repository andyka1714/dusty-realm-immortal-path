# 修煉經驗與境界數值詳解 (Cultivation Experience Specs)

本文檔詳細解析《塵寰仙途》中的修煉值獲取邏輯與境界升級所需的經驗曲線設計。

## 1. 核心設計邏輯

修煉之路漫長且艱辛，我們將其劃分為三個階段，以不同的成長曲線來模擬修仙者的心境變化與難度遞增。

### 階段一：凡人期 (Lv.1-10) —— 線性引導
**公式**：$Exp = Base \times Level$
*   **邏輯**：「引氣入體」階段，身體適應靈氣的過程。
*   **特徵**：成長平滑，數值可預期 (100 -> 1000)。
*   **目標**：讓玩家快速獲得升級成就感，無壓力熟悉系統。

### 階段二：練氣期 (Lv.11-20) —— 指數萌芽
**公式**：$Exp = Base \times Growth^{(Level - StageStart)}$
*   **邏輯**：正式踏入修真門檻，經脈拓寬，每層所需的靈氣量呈指數增長。
*   **特徵**：每升一級，需求量增加 25% (Growth 1.25)。
*   **目標**：玩家開始感受到「瓶頸」，引導其尋求丹藥、聚靈陣等外部輔助。

### 階段三：築基期以上 (Lv.21-110) —— 階段性階梯
**公式**：$Exp = Base \times Growth^{(L - StageStart)}$
*   **邏輯**：大境界之間存在巨大的「靈氣鴻溝」($Base$ 跳躍)，而小境界內則維持穩定的指數壓力。
*   **特徵**：
    *   **Base 跳躍**：跨越大境界時，基礎值 (Base) 會數倍於前一境界，代表生命層次的質變。
    *   **Growth 遞減**：隨著境界提升，Growth（成長係數）會逐漸降低 (1.15 -> 1.06)，這是為了避免數值在後期過度膨脹到無法計算，同時大境界本身的高 Base 已足夠提供壓制力。

---

## 2. 境界進階公式變數拆解

$$Exp = Base \times Growth^{(L - StageStart)}$$

### 變數定義

1.  **$Exp$ (升級所需修煉值)**：
    *   突破當前小境界 (Minor Realm) 進入下一層所需的靈氣積累量。

2.  **$Base$ (境界起始基準值)**：
    *   該大境界第一層 (Level 0) 的基礎經驗需求。
    *   *設計意圖*：控制大境界之間的難度跨度。例如從築基 (15k) 到 金丹 (100k)，難度瞬間提升近 7 倍。

3.  **$Growth$ (成長底數/難度係數)**：
    *   小境界內，每一級比前一級難多少倍。
    *   *設計意圖*：決定該境界內的「爬升陡峭度」。低階境界係數高 (1.25) 以快速篩選凡人；高階境界係數低 (1.06) 因為基數已經極大。

4.  **$L$ 與 $StageStart$ (小境界層數)**：
    *   公式中的指數部分實質上等於 `Current Minor Realm` (0-9)。
    *   $L - StageStart$ 確保了每個大境界開始時，指數歸零 ($Growth^0 = 1$)，經驗值回歸到 $Base$。

---

## 3. 全境界數值設定表 (The 12 Realms)

目前遊戲設定共 12 個大境界，每個大境界包含 10 個小境界 (0-9 層)。
總等級上限約為 Lv.120 (仙帝為終點)。

| 大境界 (ID) | 對應等級 | Base (基礎值) | Growth (成長係數) | 區間預估值 (Start -> End) |
| :--- | :--- | :--- | :--- | :--- |
| **0. 凡人 (Mortal)** | Lv.1-10 | 100 (每級+100) | **Linear** | 100 -> 1,000 |
| **1. 練氣 (Qi Refining)** | Lv.11-20 | 1,000 | **1.25** | 1,000 -> 7,450 |
| **2. 築基 (Foundation)** | Lv.21-30 | 15,000 | **1.15** | 15,000 -> 52,760 |
| **3. 金丹 (Golden Core)** | Lv.31-40 | 100,000 | 1.14 | 100k -> 325k |
| **4. 元嬰 (Nascent Soul)** | Lv.41-50 | 1,000,000 | 1.13 | 1m -> 3m |
| **5. 化神 (Spirit Severing)** | Lv.51-60 | 10,000,000 | 1.12 | 10m -> 27.7m |
| **6. 煉虛 (Void Refining)** | Lv.61-70 | 50,000,000 | 1.11 | 50m -> 128m |
| **7. 合體 (Fusion)** | Lv.71-80 | 200,000,000 | 1.10 | 200m -> 471m |
| **8. 大乘 (Mahayana)** | Lv.81-90 | 1,000,000,000 | 1.09 | 1b -> 2.17b |
| **9. 渡劫 (Tribulation)** | Lv.91-100 | 5,000,000,000 | 1.08 | 5b -> 10b |
| **10. 仙人 (Immortal)** | Lv.101-110 | 100,000,000,000 | **1.06** | 100b -> 168b |
| **11. 仙帝 (Emperor)** | Lv.111 (Max) | - | - | **Max Level (無限)** |

### 試算範例：築基期 (Foundation)
設定：$Base = 15,000$, $Growth = 1.15$
*   **Lv.21 (初期)**: $15,000 \times 1.15^0 = 15,000$
*   **Lv.22 (初期)**: $15,000 \times 1.15^1 = 17,250$
*   **Lv.23 (初期)**: $15,000 \times 1.15^2 \approx 19,837$
*   **...**
*   **Lv.30 (圓滿)**: $15,000 \times 1.15^9 \approx 52,760$

---

## 4. 數值膨脹控制 (Inflation Control)

為了確保遊戲後期的數值不會溢出 JavaScript `Number.MAX_SAFE_INTEGER` (約 $9 \times 10^{15}$)，我們在設計時採取了以下控制措施：

1.  **遞減的 Growth**：從練氣期的 1.25 一路降至仙人的 1.06。若維持 1.25 不變，仙人期的數值將會達到天文數字。
2.  **大境界 Base 手動控制**：Base 值的設定是手動調整的錨點，讓我們可以精確控制每個階段的遊戲時長預期。
3.  **仙人階段的收斂**：到達仙人 (Level 100+) 後，雖然數值依然巨大 (千億級)，但成長幅度(6%)已相當平緩，重點轉向資源爭奪與PVP/PVE屬性積累，而非單純的掛機數值等待。

---

## 5. 修煉速率公式 (Cultivation Rate)

角色每秒獲得的修煉值 (Exp/s) 受到多重因素影響：

> **核心公式**：
> `最終修復速率 = (根骨 × 境界係數 × 靈根倍率 × 聚靈陣倍率 × 閉關倍率) × 運轉效率`

### 參數詳解

1.  **根骨 (Root Bone)**：角色的基礎屬性，直接決定基礎速率。
2.  **境界係數 (Realm Modifier)**：境界越高，吸收靈氣越快。
    *   *練氣*: 0.1x / *築基*: 0.2x / ...
3.  **靈根倍率 (Spirit Root)**：天賦影響。
    *   *天靈根*: 2.0x / *變異*: 1.7x / *真靈根*: 1.3x / *雜靈根*: 1.0x
4.  **聚靈陣倍率 (Gathering Array)**：洞府設施加成。
    *   公式：`1 + (Level × 0.05)`
    *   範例：Lv.10 = 1.5x (+50%)
5.  **閉關狀態 (Seclusion)**：
    *   *常態*: 1.0x
    *   *閉關中*: 2.0x (需消耗靈石開啟)
6.  **運轉效率 (Efficiency)**：
    *   **自然運轉 (Passive)**：**30% (0.3)**。角色在線或離線掛機時的預設狀態。
    *   **手動引氣 (Manual)**：**100% (1.0)**。玩家手動點擊「修煉」按鈕時。

---

## 6. 聚靈陣 (Gathering Array)

聚靈陣是洞府的核心設施，能直接提升修煉速率倍率。

### 升級費用 (Cost Formula)

為了體現修仙資源爭奪的殘酷，聚靈陣的升級費用呈**指數增長**：

$$Cost = \lfloor 100 \times 1.5^{(Level - 1)} \rfloor$$

| 等級 (Level) | 加成 (Bonus) | 升級費用 (Cost) | 備註 |
| :--- | :--- | :--- | :--- |
| **Lv. 1 -> 2** | +10% | **100** | 凡人起步 |
| **Lv. 5 -> 6** | +30% | **506** | 練氣期 |
| **Lv. 10 -> 11** | +55% | **3,844** | 築基期門檻 |
| **Lv. 15 -> 16** | +80% | **29,192** | 築基後期 |
| **Lv. 20 -> 21** | +105% | **221,683** | 金丹期 |
| **Lv. 30 -> 31** | +155% | **12,800,000** | 化神期 |

> 註：後期每升一級需要消耗海量靈石，需依賴高階洞府與擊殺高階妖獸獲取。
